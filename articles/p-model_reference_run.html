<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sofunCalVal">
<title>P-model reference run • sofunCalVal</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="P-model reference run">
<meta property="og:description" content="sofunCalVal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sofunCalVal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/p-model_reference_run.html">P-model reference run</a>
    <a class="dropdown-item" href="../articles/p-model_run.html">P-model current run</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/computationales/sofunCalVal/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="p-model_reference_run_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>P-model reference run</h1>
                        <h4 data-toc-skip class="author">Koen Hufkens</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/computationales/sofunCalVal/blob/HEAD/vignettes/p-model_reference_run.Rmd" class="external-link"><code>vignettes/p-model_reference_run.Rmd</code></a></small>
      <div class="d-none name"><code>p-model_reference_run.Rmd</code></div>
    </div>

    
    
<p>This routine loads the reference model version to then execute a reference model (rsofun v4.2) run on the sites as used in the Stocker et al. 2018 New Phytologist paper. The output of the analysis serves as a soft (visual benchmark for model performance). This data will be updated whenever a new tag is released in the rsofun github repo (or when manually triggered from the github interface).</p>
<div class="section level2">
<h2 id="model-run">Model run<a class="anchor" aria-label="anchor" href="#model-run"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># use a fixed model parameter set</span>
<span class="co"># assuming the same underlying mechanics</span>
<span class="co"># we'll not update these in new runs</span>
<span class="va">params_modl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    kphio           <span class="op">=</span> <span class="fl">0.09423773</span>,
    soilm_par_a     <span class="op">=</span> <span class="fl">0.33349283</span>,
    soilm_par_b     <span class="op">=</span> <span class="fl">1.45602286</span>,
    
    <span class="co"># Note, latter parameters were not calibrated</span>
    tau_acclim_tempstress <span class="op">=</span> <span class="fl">10</span>, 
    par_shape_tempstress  <span class="op">=</span> <span class="fl">0.0</span> 
  <span class="op">)</span>

<span class="co"># run the model</span>
<span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">rsofun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rsofun/man/runread_pmodel_f.html" class="external-link">runread_pmodel_f</a></span><span class="op">(</span>
  <span class="va">drivers</span>,
  par <span class="op">=</span> <span class="va">params_modl</span>
  <span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-evaluation">Run evaluation<a class="anchor" aria-label="anchor" href="#run-evaluation"></a>
</h2>
<p>This runs the <code><a href="../reference/eval_sofun.html">eval_sofun()</a></code> routine included in the sofunCalVal package, and outputs daily, monthly and annual summary statistics comparing observed with simulated values. We’ll retake this same routine when running on the latest release (i.e. the workflow is equivalent but for the release of the <code>rsofun</code> package)</p>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<table class="table">
<thead><tr class="header">
<th align="left">Level</th>
<th align="right">rsq</th>
<th align="right">rmse</th>
<th align="right">slope</th>
<th align="right">bias</th>
<th align="right">nvals</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">daily_pooled</td>
<td align="right">0.7076397</td>
<td align="right">2.155868</td>
<td align="right">0.9397498</td>
<td align="right">0.0059919</td>
<td align="right">150494</td>
</tr>
<tr class="even">
<td align="left">xdaily_pooled</td>
<td align="right">0.7667889</td>
<td align="right">1.879513</td>
<td align="right">1.0271663</td>
<td align="right">0.0100348</td>
<td align="right">20917</td>
</tr>
<tr class="odd">
<td align="left">annual_pooled</td>
<td align="right">0.5197694</td>
<td align="right">349.393069</td>
<td align="right">0.9093031</td>
<td align="right">-5.8664208</td>
<td align="right">400</td>
</tr>
<tr class="even">
<td align="left">monthly_pooled</td>
<td align="right">0.7920873</td>
<td align="right">1.677057</td>
<td align="right">1.0468155</td>
<td align="right">-0.0916048</td>
<td align="right">4867</td>
</tr>
<tr class="odd">
<td align="left">spatial</td>
<td align="right">0.6645788</td>
<td align="right">367.338542</td>
<td align="right">1.0530805</td>
<td align="right">-59.6736687</td>
<td align="right">56</td>
</tr>
<tr class="even">
<td align="left">anomalies_annual</td>
<td align="right">0.0622499</td>
<td align="right">170.102731</td>
<td align="right">0.3788015</td>
<td align="right">-2.6814457</td>
<td align="right">400</td>
</tr>
<tr class="odd">
<td align="left">meandoy</td>
<td align="right">0.8118084</td>
<td align="right">1.606880</td>
<td align="right">1.0610294</td>
<td align="right">-0.0669183</td>
<td align="right">20627</td>
</tr>
<tr class="even">
<td align="left">anomalies_daily</td>
<td align="right">0.3097986</td>
<td align="right">1.558954</td>
<td align="right">0.4641699</td>
<td align="right">-0.0383123</td>
<td align="right">150380</td>
</tr>
<tr class="odd">
<td align="left">meanxoy</td>
<td align="right">0.8316770</td>
<td align="right">1.510700</td>
<td align="right">1.0789618</td>
<td align="right">-0.0990522</td>
<td align="right">2622</td>
</tr>
<tr class="even">
<td align="left">anomalies_xdaily</td>
<td align="right">0.1723231</td>
<td align="right">1.194098</td>
<td align="right">0.4330005</td>
<td align="right">-0.0044250</td>
<td align="right">20917</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="daily-and-annual-scatterplots">Daily and annual scatterplots<a class="anchor" aria-label="anchor" href="#daily-and-annual-scatterplots"></a>
</h3>
<p><img src="p-model_reference_run_files/figure-html/unnamed-chunk-4-1.png" width="700"><img src="p-model_reference_run_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="mean-seasonal-cycle">Mean seasonal cycle<a class="anchor" aria-label="anchor" href="#mean-seasonal-cycle"></a>
</h3>
<p><img src="p-model_reference_run_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="drought-response">Drought response<a class="anchor" aria-label="anchor" href="#drought-response"></a>
</h3>
<p><img src="p-model_reference_run_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="consistency-with-rpmodel">Consistency with rpmodel<a class="anchor" aria-label="anchor" href="#consistency-with-rpmodel"></a>
</h3>
<p>Since rsofun takes time series forcing, overwrite forcing with constant values corresponding to the arguments provided to <code><a href="https://rdrr.io/pkg/rpmodel/man/rpmodel.html" class="external-link">rpmodel::rpmodel()</a></code>.</p>
<div class="section level4">
<h4 id="setup-org">Setup ORG<a class="anchor" aria-label="anchor" href="#setup-org"></a>
</h4>
<pre><code><span class="co">## [1] "Are values equivalent for:"</span></code></pre>
<pre><code><span class="co">## [1] "- ci:ca: Mean relative difference: 0.0008674093"</span></code></pre>
<pre><code><span class="co">## [1] "- GPP: Mean relative difference: 0.3443244"</span></code></pre>
<pre><code><span class="co">## [1] "- Vcmax: Mean relative difference: 0.3416065"</span></code></pre>
<pre><code><span class="co">## [1] "- Vcmax25: Mean relative difference: 0.3416047"</span></code></pre>
<pre><code><span class="co">## [1] "- Jmax: Mean relative difference: 0.3442008"</span></code></pre>
<pre><code><span class="co">## [1] "- Jmax25: Mean relative difference: 0.3441996"</span></code></pre>
</div>
<div class="section level4">
<h4 id="setup-brc">Setup BRC<a class="anchor" aria-label="anchor" href="#setup-brc"></a>
</h4>
<pre><code><span class="co">## [1] "Are values equivalent for:"</span></code></pre>
<pre><code><span class="co">## [1] "- ci:ca: Mean relative difference: 0.0008674093"</span></code></pre>
<pre><code><span class="co">## [1] "- GPP: Mean relative difference: 0.0004946114"</span></code></pre>
<pre><code><span class="co">## [1] "- Vcmax: Mean relative difference: 0.003648526"</span></code></pre>
<pre><code><span class="co">## [1] "- Vcmax25: Mean relative difference: 0.003651283"</span></code></pre>
<pre><code><span class="co">## [1] "- Jmax: Mean relative difference: 0.1193008"</span></code></pre>
<pre><code><span class="co">## [1] "- Jmax25: Mean relative difference: 0.1193027"</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## R version 4.1.3 (2022-03-10)</span>
<span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">## Running under: Ubuntu 20.04.4 LTS</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0</span>
<span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span>
<span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span>
<span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span>
<span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">##  [1] rpmodel_1.2.0      RColorBrewer_1.1-3 LSD_4.0-0          rsofun_4.2        </span>
<span class="co">##  [5] knitr_1.38         lubridate_1.8.0    ggplot2_3.3.5      readr_2.1.2       </span>
<span class="co">##  [9] tidyr_1.2.0        dplyr_1.0.8       </span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##  [1] nlme_3.1-157         fs_1.5.2             usethis_2.1.5       </span>
<span class="co">##  [4] devtools_2.4.3       bit64_4.0.5          rprojroot_2.0.3     </span>
<span class="co">##  [7] tools_4.1.3          bslib_0.3.1          utf8_1.2.2          </span>
<span class="co">## [10] R6_2.5.1             mgcv_1.8-40          colorspace_2.0-3    </span>
<span class="co">## [13] yardstick_0.0.9      withr_2.5.0          tidyselect_1.1.2    </span>
<span class="co">## [16] prettyunits_1.1.1    processx_3.5.3       Brobdingnag_1.2-7   </span>
<span class="co">## [19] bit_4.0.4            curl_4.3.2           compiler_4.1.3      </span>
<span class="co">## [22] textshaping_0.3.6    cli_3.2.0            desc_1.4.1          </span>
<span class="co">## [25] GenSA_1.1.7          labeling_0.4.2       sass_0.4.1          </span>
<span class="co">## [28] scales_1.2.0         mvtnorm_1.1-3        callr_3.7.0         </span>
<span class="co">## [31] pkgdown_2.0.2        systemfonts_1.0.4    stringr_1.4.0       </span>
<span class="co">## [34] digest_0.6.29        minqa_1.2.4          rmarkdown_2.13      </span>
<span class="co">## [37] DHARMa_0.4.5         pkgconfig_2.0.3      htmltools_0.5.2     </span>
<span class="co">## [40] lme4_1.1-29          sessioninfo_1.2.2    highr_0.9           </span>
<span class="co">## [43] fastmap_1.1.0        rlang_1.0.2          farver_2.1.0        </span>
<span class="co">## [46] jquerylib_0.1.4      generics_0.1.2       jsonlite_1.8.0      </span>
<span class="co">## [49] vroom_1.5.7          magrittr_2.0.3       Matrix_1.4-1        </span>
<span class="co">## [52] Rcpp_1.0.8.3         munsell_0.5.0        fansi_1.0.3         </span>
<span class="co">## [55] lifecycle_1.0.1      stringi_1.7.6        BayesianTools_0.1.7 </span>
<span class="co">## [58] pROC_1.18.0          yaml_2.3.5           MASS_7.3-56         </span>
<span class="co">## [61] brio_1.1.3           plyr_1.8.7           pkgbuild_1.3.1      </span>
<span class="co">## [64] grid_4.1.3           parallel_4.1.3       crayon_1.5.1        </span>
<span class="co">## [67] lattice_0.20-45      splines_4.1.3        hms_1.1.1           </span>
<span class="co">## [70] ps_1.6.0             pillar_1.7.0         boot_1.3-28         </span>
<span class="co">## [73] pkgload_1.2.4        glue_1.6.2           evaluate_0.15       </span>
<span class="co">## [76] remotes_2.4.2        vctrs_0.4.1          nloptr_2.0.0        </span>
<span class="co">## [79] tzdb_0.3.0           testthat_3.1.3       gtable_0.3.0        </span>
<span class="co">## [82] purrr_0.3.4          cachem_1.0.6         xfun_0.30           </span>
<span class="co">## [85] coda_0.19-4          ragg_1.2.2           tibble_3.1.6        </span>
<span class="co">## [88] memoise_2.0.1        ellipsis_0.3.2       bridgesampling_1.1-2</span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Koen Hufkens.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
