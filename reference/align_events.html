<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Aligns data by events — align_events • sofunCalVal</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aligns data by events — align_events"><meta name="description" content="Uses a vectory specifying whether data falls into an event to reshape data,
aligning by the onset of the event"><meta property="og:description" content="Uses a vectory specifying whether data falls into an event to reshape data,
aligning by the onset of the event"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sofunCalVal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/0_p-model_current_run.html">P-model current run</a></li>
    <li><a class="dropdown-item" href="../articles/1_p-model_reference_run.html">P-model reference run</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/geco-bern/sofunCalVal/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Aligns data by events</h1>
      <small class="dont-index">Source: <a href="https://github.com/geco-bern/sofunCalVal/blob/main/R/align_events.R" class="external-link"><code>R/align_events.R</code></a></small>
      <div class="d-none name"><code>align_events.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses a vectory specifying whether data falls into an event to reshape data,
aligning by the onset of the event</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">align_events</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">df_isevent</span>,</span>
<span>  <span class="va">dovars</span>,</span>
<span>  <span class="va">leng_threshold</span>,</span>
<span>  <span class="va">before</span>,</span>
<span>  <span class="va">after</span>,</span>
<span>  do_norm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nbins <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  normbin <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>A data frame containing all data continuously along time,
required columns: <code>"site", "date"</code>.</p></dd>


<dt id="arg-df-isevent">df_isevent<a class="anchor" aria-label="anchor" href="#arg-df-isevent"></a></dt>
<dd><p>A data frame <code>nrow(df_isevent)==nrow(df)</code> specifying
whether respective dates (matching dates in <code>df</code>), satisfy a condition
that is used to define events. Events are then derived by this function as
consecutive dates where this condition is satisfied (the minimum length for
defining an event is given by argument <code>leng_threshold</code>). Required
columns in both <code>df</code> and <code>df_isevent</code>: <code>"site", "date"</code></p></dd>


<dt id="arg-dovars">dovars<a class="anchor" aria-label="anchor" href="#arg-dovars"></a></dt>
<dd><p>A vector of character strings specifying which columns
(by column name) of <code>df</code> to re-arrange.</p></dd>


<dt id="arg-leng-threshold">leng_threshold<a class="anchor" aria-label="anchor" href="#arg-leng-threshold"></a></dt>
<dd><p>An integer specifying the minimum number of consecutive
dates required to define an event. All events of length lower than
<code>leng_threshold</code> are dropped.</p></dd>


<dt id="arg-before">before<a class="anchor" aria-label="anchor" href="#arg-before"></a></dt>
<dd><p>An integer specifying the number of days before the event
onset to be retained in re-arranged data</p></dd>


<dt id="arg-after">after<a class="anchor" aria-label="anchor" href="#arg-after"></a></dt>
<dd><p>An integer specifying the number of days after the event
onset to be retained in re-arranged data</p></dd>


<dt id="arg-do-norm">do_norm<a class="anchor" aria-label="anchor" href="#arg-do-norm"></a></dt>
<dd><p>A logical specifying whether re-arranged data is to be
normalised by the median value of the bin
(number of bins given by argument <code>nbins</code>) before the event onset,
given by argument <code>normbin</code>. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-nbins">nbins<a class="anchor" aria-label="anchor" href="#arg-nbins"></a></dt>
<dd><p>An integer, specifying the number of bins used to determine
median values before event onset. Only used when codedo_norm=TRUE.
Defaults to 6.</p></dd>


<dt id="arg-normbin">normbin<a class="anchor" aria-label="anchor" href="#arg-normbin"></a></dt>
<dd><p>An integer, specifying the bin number just before the event
onset, used for normalisation. Only used when codedo_norm=TRUE.
Defaults to 2.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list of data frames (<code>list( "df_dday", "df_dday_aggbydday")</code>)
containing data from all events and <code>before + after</code> dates (relative
to event onset) with additional columns named <code>"inst"</code>, defining the
event number (instance), and <code>"dday"</code>, defining the date relative to the
respective event onset. The data frame <code>"df_dday"</code> contains rearranged,
but otherwise unchanged data (unless <code>do_norm</code>=TRUE). The data frame
<code>"df_dday_aggbydday"</code> containes data aggregated across events with the
 mean and quantiles given for each <code>"dday"</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">df_alg</span> <span class="op">&lt;-</span> <span class="fu">align_events</span><span class="op">(</span> <span class="va">df</span>, <span class="va">truefalse</span>, before<span class="op">=</span><span class="fl">30</span>, after<span class="op">=</span><span class="fl">300</span> <span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in df %&gt;% left_join(df_isevent, by = c("site", "date")) %&gt;% mutate(idx_df = 1:n()):</span> could not find function "%&gt;%"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Koen Hufkens.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

